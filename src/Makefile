# –ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –∏ —Ñ–ª–∞–≥–∏
CC = gcc
CFLAGS = -Wall -Wextra -Werror -std=c11

# –ü–∞–ø–∫–∞ –¥–ª—è –∏—Å–ø–æ–ª–Ω—è–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤ (–æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ src/)
BUILD_DIR = ../build

# –ò—Å—Ö–æ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã (–≤ —Ç–æ–π –∂–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ src/)
STRING_SRC = s21_string.c
TEST_SRC = s21_string_test.c

# –ò—Å–ø–æ–ª–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã
TARGET_STRLEN = $(BUILD_DIR)/Quest_1
TARGET_STRCMP = $(BUILD_DIR)/Quest_2
TARGET_STRCPY = $(BUILD_DIR)/Quest_3
TARGET_STRCAT = $(BUILD_DIR)/Quest_4
TARGET_STRCHR = $(BUILD_DIR)/Quest_5
TARGET_STRSTR = $(BUILD_DIR)/Quest_6
TARGET_STRTOK = $(BUILD_DIR)/Quest_7

# –§–ª–∞–≥–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–≤–µ—Å—Ç–∞
FLAGS_QUEST_1 = -DQUEST_1
FLAGS_QUEST_2 = -DQUEST_2
FLAGS_QUEST_3 = -DQUEST_3
FLAGS_QUEST_4 = -DQUEST_4
FLAGS_QUEST_5 = -DQUEST_5
FLAGS_QUEST_6 = -DQUEST_6
FLAGS_QUEST_7 = -DQUEST_7

.PHONY: all strlen_tests strcmp_tests strcpy_tests strcat_tests strchr_tests strstr_tests strtok_tests clean test

# –¶–µ–ª—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: —Å–æ–±—Ä–∞—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã
all: strlen_tests strcmp_tests strcpy_tests strcat_tests strchr_tests strstr_tests strtok_tests

# === Quest 1: s21_strlen ===
strlen_tests: $(TARGET_STRLEN)

$(TARGET_STRLEN): $(STRING_SRC) $(TEST_SRC) | $(BUILD_DIR)
	$(CC) $(CFLAGS) $(FLAGS_QUEST_1) $(STRING_SRC) $(TEST_SRC) -o $(TARGET_STRLEN)
	@echo "‚úÖ –°–±–æ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞: $(TARGET_STRLEN)"

# === Quest 2: s21_strcmp ===
strcmp_tests: $(TARGET_STRCMP)

$(TARGET_STRCMP): $(STRING_SRC) $(TEST_SRC) | $(BUILD_DIR)
	$(CC) $(CFLAGS) $(FLAGS_QUEST_2) $(STRING_SRC) $(TEST_SRC) -o $(TARGET_STRCMP)
	@echo "‚úÖ –°–±–æ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞: $(TARGET_STRCMP)"

# === Quest 3: s21_strcpy ===
strcpy_tests: $(TARGET_STRCPY)

$(TARGET_STRCPY): $(STRING_SRC) $(TEST_SRC) | $(BUILD_DIR)
	$(CC) $(CFLAGS) $(FLAGS_QUEST_3) $(STRING_SRC) $(TEST_SRC) -o $(TARGET_STRCPY)
	@echo "‚úÖ –°–±–æ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞: $(TARGET_STRCPY)"

# === Quest 4: s21_strcat ===
strcat_tests: $(TARGET_STRCAT)

$(TARGET_STRCAT): $(STRING_SRC) $(TEST_SRC) | $(BUILD_DIR)
	$(CC) $(CFLAGS) $(FLAGS_QUEST_4) $(STRING_SRC) $(TEST_SRC) -o $(TARGET_STRCAT)
	@echo "‚úÖ –°–±–æ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞: $(TARGET_STRCAT)"

# === Quest 5: s21_strchr ===
strchr_tests: $(TARGET_STRCHR)

$(TARGET_STRCHR): $(STRING_SRC) $(TEST_SRC) | $(BUILD_DIR)
	$(CC) $(CFLAGS) $(FLAGS_QUEST_5) $(STRING_SRC) $(TEST_SRC) -o $(TARGET_STRCHR)
	@echo "‚úÖ –°–±–æ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞: $(TARGET_STRCHR)"

# === Quest 6: s21_strstr ===
strstr_tests: $(TARGET_STRSTR)

$(TARGET_STRSTR): $(STRING_SRC) $(TEST_SRC) | $(BUILD_DIR)
	$(CC) $(CFLAGS) $(FLAGS_QUEST_6) $(STRING_SRC) $(TEST_SRC) -o $(TARGET_STRSTR)
	@echo "‚úÖ –°–±–æ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞: $(TARGET_STRSTR)"

# === Quest 7: s21_strtok ===
strtok_tests: $(TARGET_STRTOK)

$(TARGET_STRTOK): $(STRING_SRC) $(TEST_SRC) | $(BUILD_DIR)
	$(CC) $(CFLAGS) $(FLAGS_QUEST_7) $(STRING_SRC) $(TEST_SRC) -o $(TARGET_STRTOK)
	@echo "‚úÖ –°–±–æ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞: $(TARGET_STRTOK)"

# –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ build (–æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ src: ../../build)
$(BUILD_DIR):
	mkdir -p $(BUILD_DIR)

# –¶–µ–ª—å –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤ (–µ—Å–ª–∏ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã —É–∂–µ —Å–æ–±—Ä–∞–Ω—ã)
test:
	@echo "=== –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤ ==="
	@./$(TARGET_STRLEN) || echo "‚ùå Quest_1 failed"
	@./$(TARGET_STRCMP) || echo "‚ùå Quest_2 failed"
	@./$(TARGET_STRCPY) || echo "‚ùå Quest_3 failed"
	@./$(TARGET_STRCAT) || echo "‚ùå Quest_4 failed"
	@./$(TARGET_STRCHR) || echo "‚ùå Quest_5 failed"
	@./$(TARGET_STRSTR) || echo "‚ùå Quest_6 failed"
	@./$(TARGET_STRTOK) || echo "‚ùå Quest_7 failed"

# –û—á–∏—Å—Ç–∫–∞
clean:
	rm -rf $(BUILD_DIR)
	@echo "üßπ –û—á–∏—Å—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞"

# –°–ø—Ä–∞–≤–∫–∞
help:
	@echo "üéØ –î–æ—Å—Ç—É–ø–Ω—ã–µ —Ü–µ–ª–∏:"
	@echo "  all          - –°–æ–±—Ä–∞—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã (Quest_1..7)"
	@echo "  test         - –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å–æ–±—Ä–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã"
	@echo "  clean        - –£–¥–∞–ª–∏—Ç—å –ø–∞–ø–∫—É build"
	@echo ""
	@echo "üöÄ –°–±–æ—Ä–∫–∞ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤:"
	@echo "  make strlen_tests   - –°–æ–±—Ä–∞—Ç—å Quest_1 (s21_strlen)"
	@echo "  make strcmp_tests   - –°–æ–±—Ä–∞—Ç—å Quest_2 (s21_strcmp)"
	@echo "  make strcpy_tests   - –°–æ–±—Ä–∞—Ç—å Quest_3 (s21_strcpy)"
	@echo "  make strcat_tests   - –°–æ–±—Ä–∞—Ç—å Quest_4 (s21_strcat)"
	@echo "  make strchr_tests   - –°–æ–±—Ä–∞—Ç—å Quest_5 (s21_strchr)"
	@echo "  make strstr_tests   - –°–æ–±—Ä–∞—Ç—å Quest_6 (s21_strstr)"
	@echo "  make strtok_tests   - –°–æ–±—Ä–∞—Ç—å Quest_7 (s21_strtok)"